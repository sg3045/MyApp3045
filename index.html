<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>エンタメログ (アニメ・ドラマ特化版)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #f4f7f6; color: #333; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        h1 { background-color: #4CAF50; color: white; padding: 18px 0; text-align: center; margin-top: 0; font-size: 26px; box-shadow: 0 3px 6px rgba(0,0,0,0.15); letter-spacing: 1.5px; font-weight: 700; }
        .container { display: flex; flex-direction: column; flex-grow: 1; padding: 25px; overflow-y: auto; background-image: linear-gradient(to bottom, #e8f5e9, #ffffff); }
        .section { background-color: white; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.12); margin-bottom: 30px; padding: 30px; transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out; }
        .section:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .section h2 { color: #2e7d32; margin-top: 0; font-size: 24px; border-bottom: 3px solid #a5d6a7; padding-bottom: 15px; margin-bottom: 25px; font-weight: 700; letter-spacing: 0.5px; }
        .input-group { display: flex; align-items: center; margin-bottom: 15px; }
        .input-group label { min-width: 150px; margin-right: 20px; font-weight: bold; color: #555; font-size: 16px; }
        .input-group input[type="text"], .input-group input[type="number"] { flex-grow: 1; padding: 12px; border: 1px solid #c8e6c9; border-radius: 8px; font-size: 16px; transition: border-color 0.2s, box-shadow 0.2s; }
        .input-group input[type="text"]:focus, .input-group input[type="number"]:focus { border-color: #4CAF50; outline: none; box-shadow: 0 0 0 4px rgba(76, 175, 80, 0.3); }
        .input-group button { background-color: #4CAF50; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; margin-left: 20px; font-size: 16px; font-weight: 600; transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
        .input-group button:hover { background-color: #45a049; transform: translateY(-2px); box-shadow: 0 5px 10px rgba(0,0,0,0.15); }
        .input-group button:active { transform: translateY(0); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        textarea { width: calc(100% - 30px); height: 180px; padding: 20px; border: 1px solid #ddd; border-radius: 10px; font-family: 'Consolas', 'Courier New', monospace; font-size: 14px; line-height: 1.6; resize: vertical; margin-top: 20px; background-color: #e8f5e9; color: #333; box-shadow: inset 0 1px 3px rgba(0,0,0,0.05); }
        .button-group { display: flex; justify-content: space-around; margin-top: 25px; }
        .button-group button { flex: 1; background-color: #2196F3; color: white; border: none; padding: 15px 20px; border-radius: 8px; cursor: pointer; margin: 0 10px; font-size: 17px; font-weight: 600; transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s; box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
        .button-group button:hover { background-color: #1976D2; transform: translateY(-2px); box-shadow: 0 5px 10px rgba(0,0,0,0.15); }
        .button-group button:active { transform: translateY(0); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
    <h1>エンタメログ (アニメ・ドラマ特化版)</h1>
    <div class="container">
        <div class="section">
            <h2>作品検索とサブスク情報</h2>
            <div class="input-group">
                <label for="search-media-title">作品名:</label>
                <input type="text" id="search-media-title" placeholder="作品名を入力">
                <button id="search-media-button">検索</button>
            </div>
            <textarea id="search-media-result" readonly placeholder="作品名を入力して検索してください。"></textarea>
        </div>
        <div class="section">
            <h2>視聴履歴の記録</h2>
            <div class="input-group">
                <label for="history-media-title">作品名:</label>
                <input type="text" id="history-media-title" placeholder="例: 葬送のフリーレン">
            </div>
            <div class="input-group">
                <label for="history-start-date">開始日 (YYYY-MM-DD):</label>
                <input type="text" id="history-start-date" placeholder="例: 2024-01-01">
            </div>
            <div class="input-group">
                <label for="history-end-date">終了日 (YYYY-MM-DD):</label>
                <input type="text" id="history-end-date" placeholder="例: 2024-03-31">
            </div>
            <div class="input-group">
                <label for="history-rating">評価 (1-5):</label>
                <input type="number" id="history-rating" min="1" max="5" value="5">
            </div>
            <div class="input-group">
                <label for="history-tags">タグ (カンマ区切り):</label>
                <input type="text" id="history-tags" placeholder="例: ファンタジー, 冒険, 感動">
            </div>
            <div class="input-group">
                <label for="history-notes">メモ:</label>
                <input type="text" id="history-notes" placeholder="任意でメモを入力">
            </div>
            <button id="record-history-button">履歴を記録</button>
        </div>
        <div class="section">
            <h2>履歴表示とAIおすすめ</h2>
            <div class="button-group">
                <button id="display-history-button">視聴履歴を表示</button>
                <button id="ai-recommend-button">AIおすすめ作品</button>
                <button id="reset-history-button" style="background-color: #f44336;">履歴をリセット</button>
            </div>
            <textarea id="history-recommendation-result" readonly placeholder="視聴履歴の表示やAIによるおすすめ作品がここに表示されます。"></textarea>
        </div>
    </div>

    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const { ipcRenderer } = require('electron');

            const searchMediaTitleInput = document.getElementById('search-media-title');
            const searchMediaButton = document.getElementById('search-media-button');
            const searchMediaResultTextarea = document.getElementById('search-media-result');
            const historyMediaTitleInput = document.getElementById('history-media-title');
            const historyStartDateInput = document.getElementById('history-start-date');
            const historyEndDateInput = document.getElementById('history-end-date');
            const historyRatingInput = document.getElementById('history-rating');
            const historyTagsInput = document.getElementById('history-tags');
            const historyNotesInput = document.getElementById('history-notes');
            const recordHistoryButton = document.getElementById('record-history-button');
            const displayHistoryButton = document.getElementById('display-history-button');
            const aiRecommendButton = document.getElementById('ai-recommend-button');
            const historyRecommendationResultTextarea = document.getElementById('history-recommendation-result');
            const resetHistoryButton = document.getElementById('reset-history-button');

            function updateTextarea(textareaElement, text) {
                textareaElement.value = text;
                textareaElement.scrollTop = textareaElement.scrollHeight;
            }

            searchMediaButton.addEventListener('click', async () => {
                const title = searchMediaTitleInput.value;
                updateTextarea(searchMediaResultTextarea, `作品 '${title}' のサブスク情報を検索中...\n`);
                const result = await ipcRenderer.invoke('search-media', title);
                updateTextarea(searchMediaResultTextarea, result);
            });

            recordHistoryButton.addEventListener('click', async () => {
                const record = {
                    mediaTitle: historyMediaTitleInput.value,
                    startDate: historyStartDateInput.value,
                    endDate: historyEndDateInput.value,
                    rating: parseInt(historyRatingInput.value) || null,
                    notes: historyNotesInput.value,
                    tags: historyTagsInput.value
                };
                const result = await ipcRenderer.invoke('record-history', record);
                if (result.success) {
                    alert(result.message);
                    historyMediaTitleInput.value = '';
                    historyStartDateInput.value = '';
                    historyEndDateInput.value = '';
                    historyRatingInput.value = '5';
                    historyNotesInput.value = '';
                    historyTagsInput.value = '';
                } else {
                    alert(result.message);
                }
            });

            displayHistoryButton.addEventListener('click', async () => {
                updateTextarea(historyRecommendationResultTextarea, `視聴履歴を表示中...\n`);
                const result = await ipcRenderer.invoke('get-history');
                updateTextarea(historyRecommendationResultTextarea, result);
            });

            aiRecommendButton.addEventListener('click', async () => {
                updateTextarea(historyRecommendationResultTextarea, `AIにおすすめ作品を生成中...\nしばらくお待ちください。\n`);
                const result = await ipcRenderer.invoke('get-ai-recommendations-media');
                updateTextarea(historyRecommendationResultTextarea, result);
            });

            resetHistoryButton.addEventListener('click', () => {
                const isConfirmed = confirm('本当にすべての視聴履歴をリセットしますか？\nこの操作を行うとアプリが再起動します。');
                if (isConfirmed) {
                    ipcRenderer.send('reset-history');
                }
            });
        });
    </script>
</body>
</html>